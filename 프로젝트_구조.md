# MCP 서버 프로젝트 구조

## 디렉토리 구조

```
mcp_server/
├── app/                    # 애플리케이션 코드
│   ├── api/                # API 엔드포인트
│   │   ├── __init__.py
│   │   ├── chat.py         # 채팅 API
│   │   ├── generate.py     # 텍스트 생성 API
│   │   └── feedback.py     # 피드백 수집 API
│   ├── core/               # 핵심 기능
│   │   ├── __init__.py
│   │   ├── config.py       # 설정 관리
│   │   ├── security.py     # 보안 관련 기능
│   │   └── logging.py      # 로깅 설정
│   ├── protocols/          # MCP 프로토콜 구현
│   │   ├── __init__.py
│   │   ├── knowledge.py    # 지식 접근 프로토콜
│   │   ├── reasoning.py    # 분석 추론 프로토콜
│   │   ├── generation.py   # 콘텐츠 생성 프로토콜
│   │   ├── learning.py     # 적응형 학습 프로토콜
│   │   └── communication.py # 커뮤니케이션 프로토콜
│   ├── models/             # 데이터 모델
│   │   ├── __init__.py
│   │   ├── chat.py         # 채팅 관련 모델
│   │   ├── user.py         # 사용자 관련 모델
│   │   └── feedback.py     # 피드백 관련 모델
│   ├── services/           # 외부 서비스 연동
│   │   ├── __init__.py
│   │   ├── llm.py          # LLM API 연동
│   │   ├── vector_db.py    # 벡터 데이터베이스 연동
│   │   └── search.py       # 외부 검색 서비스 연동
│   ├── utils/              # 유틸리티 함수
│   │   ├── __init__.py
│   │   ├── text.py         # 텍스트 처리 유틸리티
│   │   ├── embedding.py    # 임베딩 관련 유틸리티
│   │   └── prompt.py       # 프롬프트 관련 유틸리티
│   ├── __init__.py
│   └── main.py             # 애플리케이션 진입점
├── tests/                  # 테스트 코드
│   ├── __init__.py
│   ├── conftest.py         # 테스트 설정
│   ├── test_api/           # API 테스트
│   ├── test_protocols/     # 프로토콜 테스트
│   └── test_services/      # 서비스 테스트
├── docs/                   # 문서
│   ├── api/                # API 문서
│   └── guides/             # 사용자 가이드
├── scripts/                # 유틸리티 스크립트
│   ├── setup.sh            # 환경 설정 스크립트
│   └── deploy.sh           # 배포 스크립트
├── .env.example            # 환경 변수 예시
├── .gitignore              # Git 무시 파일 목록
├── docker-compose.yml      # Docker Compose 설정
├── Dockerfile              # Docker 이미지 설정
├── pyproject.toml          # 프로젝트 메타데이터 및 의존성
├── README.md               # 프로젝트 설명
└── requirements.txt        # 의존성 목록
```

## 주요 파일 설명

### 1. 애플리케이션 진입점 (app/main.py)

애플리케이션의 시작점으로, FastAPI 인스턴스를 생성하고 라우터를 등록합니다.

### 2. API 엔드포인트 (app/api/)

- **chat.py**: 대화형 API 엔드포인트 구현
- **generate.py**: 텍스트 생성 API 엔드포인트 구현
- **feedback.py**: 사용자 피드백 수집 API 엔드포인트 구현

### 3. 프로토콜 구현 (app/protocols/)

- **knowledge.py**: 내부/외부 지식 검색 기능 구현
- **reasoning.py**: 복합 과제 분해 및 처리 기능 구현
- **generation.py**: Universal Prompt 적용 및 콘텐츠 생성 기능 구현
- **learning.py**: 대화 맥락 관리 및 피드백 처리 기능 구현
- **communication.py**: 응답 스타일 제어 및 명확성 향상 기능 구현

### 4. 외부 서비스 연동 (app/services/)

- **llm.py**: OpenAI, Google, Anthropic 등 LLM API 연동
- **vector_db.py**: ChromaDB 등 벡터 데이터베이스 연동
- **search.py**: Google Search API 등 외부 검색 서비스 연동

### 5. 설정 파일

- **.env.example**: 필요한 환경 변수 목록 및 예시
- **docker-compose.yml**: 개발 및 배포 환경 설정
- **pyproject.toml**: 프로젝트 메타데이터 및 의존성 관리

## 기술 스택 상세

### 백엔드

- **FastAPI**: 고성능 비동기 웹 프레임워크
- **Pydantic**: 데이터 검증 및 설정 관리
- **SQLAlchemy**: ORM(Object-Relational Mapping)
- **Alembic**: 데이터베이스 마이그레이션

### LLM 오케스트레이션

- **LangChain**: LLM 체인, 에이전트, RAG 구현
- **LlamaIndex**: 문서 인덱싱 및 검색

### 데이터베이스

- **PostgreSQL**: 관계형 데이터베이스
- **ChromaDB**: 벡터 데이터베이스

### 테스트

- **Pytest**: 테스트 프레임워크
- **Pytest-asyncio**: 비동기 테스트 지원

### 배포

- **Docker**: 컨테이너화
- **Docker Compose**: 다중 컨테이너 관리
- **GitHub Actions**: CI/CD 파이프라인

## 개발 환경 설정

1. 저장소 클론
   ```bash
   git clone https://github.com/username/mcp-server.git
   cd mcp-server
   ```

2. 가상 환경 생성 및 활성화
   ```bash
   python -m venv venv
   source venv/bin/activate  # Linux/Mac
   venv\Scripts\activate  # Windows
   ```

3. 의존성 설치
   ```bash
   pip install -r requirements.txt
   ```

4. 환경 변수 설정
   ```bash
   cp .env.example .env
   # .env 파일 편집하여 필요한 API 키 등 설정
   ```

5. 개발 서버 실행
   ```bash
   uvicorn app.main:app --reload
   ```

## Docker를 이용한 실행

1. Docker 이미지 빌드
   ```bash
   docker-compose build
   ```

2. Docker 컨테이너 실행
   ```bash
   docker-compose up
   ```

## 테스트 실행

```bash
pytest
```

## API 문서 접근

개발 서버 실행 후, 다음 URL에서 API 문서에 접근할 수 있습니다:

- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc